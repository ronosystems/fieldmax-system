{% extends 'website/base.html' %}
{% load static %}

{% block title %}Home - Fieldmax | Premium Tech at Unbeatable Prices{% endblock %}

{% block content %}
<style>
  /* ===== BASE STYLES WITH WHITE BACKGROUND ===== */
  body {
    color: #1e293b; /* Dark slate for text */
    background: #463232; /* Clean white background */
    position: relative;
    z-index: 1;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }

  * {
    color: inherit;
  }

  /* ===== ENHANCED BACKGROUNDS ===== */
  .video-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -2;
    overflow: hidden;
  }
  
  .video-background video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.1; /* Very subtle */
    filter: brightness(1.2) contrast(1.1);
  }
  
  .gradient-bg {
    position: fixed;
    inset: 0;
    z-index: -3;
    background: linear-gradient(135deg, 
      rgba(255, 255, 255, 0.98) 0%, 
      rgba(248, 250, 252, 0.96) 50%, 
      rgba(241, 245, 249, 0.94) 100%);
  }

  .content-overlay {
    position: relative;
    z-index: 1;
    background: linear-gradient(to bottom, 
      rgba(255, 255, 255, 0.7) 0%,
      rgba(255, 255, 255, 0.85) 50%,
      rgba(255, 255, 255, 0.95) 100%);
  }

  /* ===== IMPROVED TOP SEARCH ===== */
  .top-search-section {
    position: sticky;
    top: 0;
    z-index: 1000;
    padding: 15px 5%;
    background: rgba(255, 255, 255, 0.95);
    border-bottom: 1px solid #e2e8f0;
    backdrop-filter: blur(10px);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .top-search-form {
    max-width: 800px;
    margin: 0 auto;
    display: flex;
    background: #ffffff;
    border: 2px solid #3b82f6;
    border-radius: 50px;
    padding: 5px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 10px rgba(59, 130, 246, 0.1);
  }

  .top-search-form:focus-within {
    border-color: #2563eb;
    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
    transform: translateY(-2px);
  }

  .top-search-input {
    flex: 1;
    background: transparent;
    border: none;
    padding: 15px 20px;
    font-size: 16px;
    color: #1e293b;
    outline: none;
  }

  .top-search-input::placeholder {
    color: #94a3b8;
  }

  .top-search-btn {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    border: none;
    border-radius: 50px;
    padding: 15px 30px;
    color: white;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .top-search-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    background: linear-gradient(135deg, #2563eb, #1d4ed8);
  }

  /* ===== REDESIGNED HERO SECTION - 3 COLUMNS ===== */
  .hero {
    position: relative;
    min-height: 85vh;
    display: flex;
    align-items: center;
    padding: 60px 5% 80px;
    overflow: hidden;
    /* Replace the gradient with your image */
    background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.4)), 
                url('/static/website/images/HERO.webp');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }
  
  .hero-content {
    max-width: 1600px;
    width: 90%;
    margin: 0 auto;
  }
  
  /* 3-COLUMN GRID LAYOUT */
  .hero-grid-3col {
    display: grid;
    grid-template-columns: 1fr 1.2fr 1fr;
    gap: 40px;
    align-items: center;
  }
  
  /* COLUMNS 1 & 3 - IMAGE SLIDESHOWS */
  .hero-image-column {
    display: flex;
    flex-direction: column;
    gap: 30px;
    height: 100%;
  }
  
  .hero-slideshow-small {
    position: relative;
    width: 100%;
    height: 300px;
    overflow: hidden;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
  }
  
  .slideshow-container-small {
    position: relative;
    width: 100%;
    height: 100%;
  }
  
  .slide-small {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 1s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  
  .slide-small.active {
    opacity: 1;
  }
  
  .slide-small-title {
    color: #ffffff;
    font-size: 1.1rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 15px;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6));
    padding: 10px 20px;
    border-radius: 50px;
    text-transform: uppercase;
    letter-spacing: 1px;
    z-index: 2;
  }
  
  .slide-small img {
    max-width: 85%;
    max-height: 65%;
    object-fit: contain;
    filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.3));
    transition: transform 0.5s ease;
  }
  
  .slide-small.active img {
    animation: float 3s ease-in-out infinite;
  }
  
  /* COLUMN 2 - MAIN CONTENT */
  .hero-center-column {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 40px 30px;
    border-radius: 25px;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(15px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
  }
  
  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: linear-gradient(135deg, #0062ff, #ff0000);
    padding: 12px 25px;
    border-radius: 50px;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 30px;
    color: #ffffff;
    border: none;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.9; transform: scale(1.02); }
  }
  
  .hero-text-slideshow {
    position: relative;
    height: 220px;
    overflow: hidden;
    margin-bottom: 25px;
    width: 100%;
  }
  
  .text-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    opacity: 0;
    transition: opacity 0.8s ease;
  }
  
  .text-slide.active {
    opacity: 1;
  }
  
  .hero-title {
    font-size: clamp(2.8rem, 5vw, 4.5rem);
    font-weight: 900;
    line-height: 1.1;
    margin-bottom: 20px;
    color: #ffffff;
    text-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  }
  
  .hero-title .highlight {
    background: linear-gradient(135deg, #3b82f6 0%, #ff0000 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    display: inline-block;
    position: relative;
  }
  
  .hero-title .highlight::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(135deg, #3b82f6, #ff0000);
    border-radius: 2px;
  }
  
  .hero-subtitle {
    font-size: 1.3rem;
    line-height: 1.7;
    color: #ffdd00;
    max-width: 600px;
    margin: 0 auto 25px;
    font-weight: 500;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }
  
  .text-slideshow-nav {
    display: flex;
    gap: 10px;
    margin: 25px auto 35px;
    justify-content: center;
  }
  
  .text-nav-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid transparent;
  }
  
  .text-nav-dot:hover {
    background: #3b82f6;
    transform: scale(1.2);
  }
  
  .text-nav-dot.active {
    background: #3b82f6;
    transform: scale(1.3);
    box-shadow: 0 0 15px rgba(59, 130, 246, 0.8);
  }
  
  .hero-buttons {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 20px;
  }
  
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    padding: 18px 35px;
    border-radius: 50px;
    font-weight: 700;
    font-size: 16px;
    text-decoration: none;
    transition: all 0.3s ease;
    border: 2px solid transparent;
    text-transform: uppercase;
    letter-spacing: 0.8px;
  }
  
  .btn-primary {
    background: linear-gradient(135deg, #3b82f6 0%, #ff0000 100%);
    color: white;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
  }
  
  .btn-primary:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
  }
  
  .btn-secondary {
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    color: white;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
  }
  
  .btn-secondary:hover {
    background: rgba(59, 130, 246, 0.8);
    border-color: #3b82f6;
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(59, 130, 246, 0.3);
  }
  
  /* Image slideshow navigation for side columns */
  .slideshow-nav-small {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 10;
  }
  
  .nav-dot-small {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid transparent;
  }
  
  .nav-dot-small:hover {
    background: #3b82f6;
    transform: scale(1.2);
  }
  
  .nav-dot-small.active {
    background: #3b82f6;
    transform: scale(1.3);
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.8);
  }
  
  /* ===== ENHANCED MARQUEE ===== */
  .marquee-container {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    overflow: hidden;
    background: linear-gradient(135deg, #ffffff, #f8fafc);
    padding: 15px 0;
    border-top: 1px solid #e2e8f0;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
  }
  
  .marquee {
    display: flex;
    animation: scroll 30s linear infinite;
  }
  
  .marquee-content {
    display: flex;
    align-items: center;
    gap: 40px;
    padding-right: 40px;
  }
  
  .marquee-item {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 16px;
    font-weight: 600;
    color: #3b82f6;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 8px 20px;
    background: rgba(59, 130, 246, 0.1);
    border-radius: 50px;
    border: 1px solid rgba(59, 130, 246, 0.2);
  }

  /* ===== ENHANCED STATS SECTION ===== */
  .stats-section {
    padding: 80px 5%;
    background: linear-gradient(135deg, #f8fafc, #ffffff);
    border-top: 1px solid #e2e8f0;
    border-bottom: 1px solid #e2e8f0;
  }
  
  .stats-grid {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 30px;
  }
  
  .stat-card {
    background: #ffffff;
    border: 2px solid #e2e8f0;
    border-radius: 20px;
    padding: 40px 20px;
    text-align: center;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  }
  
  .stat-card:hover {
    transform: translateY(-8px);
    border-color: #3b82f6;
    box-shadow: 0 20px 40px rgba(59, 130, 246, 0.1);
  }
  
  .stat-number {
    font-size: 3.5rem;
    font-weight: 800;
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 10px;
    display: block;
  }
  
  .stat-label {
    font-size: 16px;
    font-weight: 600;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  /* ===== IMPROVED BEST SELLING SECTION - COMPRESSED & 6 CARDS PER ROW ===== */
  .best-selling-section {
    padding: 80px 5%;
    background: #6d6c6c;
    position: relative;
  }

  .section-header {
    text-align: center;
    margin-bottom: 40px;
  }

  .section-title {
    font-size: 3rem;
    font-weight: 800;
    color: #000000;
    margin-bottom: 15px;
  }

  .section-subtitle {
    font-size: 1.5rem;
    color: #ff00dd;
    max-width: 800px;
    margin: 0 auto;
  }

  /* Compressed Performance Cards */
  .performance-cards {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    max-width: 500px;
    margin: 0 auto 40px;
  }

  .performance-card {
    background: #ffffff;
    border: 2px solid #000000;
    border-radius: 20px;
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgb(0, 0, 0);
  }

  .performance-icon {
    font-size: 2.5rem;
    min-width: 50px;
    color: #3b82f6;
  }

  .performance-value {
    font-size: 2rem;
    font-weight: 800;
    color: #1e293b;
    margin-bottom: 5px;
  }

  /* Category Filters */
  .filters-container {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 40px;
  }

  .filter-btn {
    padding: 10px 20px;
    background: #ffffff;
    border: 2px solid #e2e8f0;
    border-radius: 50px;
    color: #475569;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .filter-btn.active {
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    border-color: transparent;
    color: white;
  }

  /* COMPRESSED PRODUCTS GRID - 6 CARDS PER ROW */
  .best-selling-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 20px;
    margin-bottom: 40px;
  }

  .best-selling-card {
    background: #ffffff;
    border: 2px solid #000000;
    border-radius: 20px;
    overflow: hidden;
    transition: all 0.3s ease;
    position: relative;
    box-shadow: 0 4px 6px rgb(0, 0, 0);
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .best-selling-card:hover {
    transform: translateY(-5px);
    border-color: #0056e1;
    box-shadow: 0 10px 20px rgb(0, 0, 0);
  }

  .product-rank {
    position: absolute;
    top: 10px;
    left: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 10;
  }

  .rank-number {
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    color: white;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 14px;
    border: 2px solid white;
  }

  .rank-badge {
    background: linear-gradient(135deg, #f59e0b, #f97316);
    color: white;
    padding: 4px 10px;
    border-radius: 15px;
    font-size: 10px;
    font-weight: 800;
  }

  /* Compressed Product Image */
  .product-image-container {
    position: relative;
    width: 100%;
    height: 150px;
    overflow: hidden;
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
  }

  .product-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 15px;
  }

  /* Compressed Product Content */
  .product-content {
    padding: 15px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .product-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }

  .product-sku {
    font-size: 12px;
    color: #64748b;
    background: #f1f5f9;
    padding: 3px 8px;
    border-radius: 12px;
    font-weight: 600;
  }

  .stock-status {
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
  }

  .product-title {
    font-size: 14px;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 10px;
    line-height: 1.3;
    flex-grow: 1;
  }

  .stars {
    display: flex;
    align-items: center;
    gap: 2px;
    margin: 8px 0;
  }

  .star {
    color: #fbbf24;
    font-size: 12px;
  }

  .rating-value {
    margin-left: 5px;
    font-weight: 600;
    color: #475569;
    font-size: 12px;
  }

  .price-current {
    font-size: 1.5rem;
    font-weight: 800;
    color: #1e293b;
    margin-bottom: 8px;
  }

  .save-badge {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 700;
    display: inline-block;
  }

  /* Compressed Actions */
  .product-actions {
    display: flex;
    gap: 8px;
    margin: 15px 0;
  }

  .action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
  }

  .add-cart-btn {
    flex: 1;
    padding: 10px;
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    color: white;
    gap: 8px;
    font-size: 12px;
  }

  .wishlist-btn,
  .compare-btn {
    width: 40px;
    height: 40px;
    background: #ffffff;
    color: #64748b;
    border: 2px solid #e2e8f0;
  }

  .btn-icon {
    font-size: 16px;
  }

  /* Compressed Quick Stats */
  .quick-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    padding-top: 15px;
    border-top: 1px solid #e2e8f0;
  }

  .stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    padding: 8px;
    background: #f8fafc;
    border-radius: 8px;
    font-size: 10px;
    text-align: center;
  }

  /* No Products */
  .no-products {
    grid-column: 1 / -1;
    text-align: center;
    padding: 40px 20px;
    color: #64748b;
  }

  /* View More */
  .view-more-container {
    text-align: center;
    margin-top: 30px;
  }

  .view-more-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 14px 30px;
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    color: white;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 700;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  /* ===== ENHANCED FEATURES ===== */
  .features-section {
    padding: 80px 5%;
    background: linear-gradient(135deg, #f8fafc, #ffffff);
    border-top: 1px solid #e2e8f0;
  }
  
  .features-grid {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px;
  }
  
  .feature-card {
    background: #ffffff;
    border: 2px solid #e2e8f0;
    border-radius: 20px;
    padding: 40px 25px;
    text-align: center;
    transition: all 0.4s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  }
  
  .feature-card:hover {
    transform: translateY(-10px);
    border-color: #3b82f6;
    box-shadow: 0 25px 50px rgba(59, 130, 246, 0.1);
  }
  
  .feature-icon {
    font-size: 3.5rem;
    margin-bottom: 25px;
    display: block;
    color: #3b82f6;
  }

  /* ===== ANIMATIONS ===== */
  @keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 1600px) {
    .best-selling-grid {
      grid-template-columns: repeat(5, 1fr);
    }
  }
  
  @media (max-width: 1400px) {
    .hero-grid-3col {
      gap: 30px;
    }
    
    .hero-slideshow-small {
      height: 280px;
    }
    
    .best-selling-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }
  
  @media (max-width: 1200px) {
    .hero-grid-3col {
      gap: 25px;
    }
    
    .hero-slideshow-small {
      height: 250px;
    }
    
    .hero-center-column {
      padding: 30px 20px;
    }
    
    .best-selling-grid {
      grid-template-columns: repeat(3, 1fr);
    }
    
    .section-title {
      font-size: 2.5rem;
    }
  }
  
  @media (max-width: 992px) {
    .hero-grid-3col {
      grid-template-columns: 1fr;
      gap: 40px;
    }
    
    .hero-image-column {
      flex-direction: row;
      gap: 20px;
    }
    
    .hero-slideshow-small {
      height: 200px;
      flex: 1;
    }
    
    .hero-center-column {
      order: -1;
      padding: 30px;
    }
    
    .hero-title {
      font-size: 2.5rem;
    }
    
    .hero-text-slideshow {
      height: 180px;
    }
    
    .best-selling-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .section-title {
      font-size: 2.2rem;
    }
  }
  
  @media (max-width: 768px) {
    .hero {
      min-height: 75vh;
      padding: 40px 5% 60px;
    }
    
    .hero-image-column {
      flex-direction: column;
    }
    
    .hero-slideshow-small {
      height: 220px;
    }
    
    .hero-title {
      font-size: 2.2rem;
    }
    
    .hero-center-column {
      padding: 25px 20px;
    }
    
    .best-selling-grid {
      grid-template-columns: 1fr;
    }
    
    .section-title {
      font-size: 2rem;
    }
    
    .top-search-form {
      flex-direction: column;
      border-radius: 20px;
      padding: 10px;
    }
    
    .top-search-input {
      border-radius: 15px;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .top-search-btn {
      width: 100%;
      border-radius: 15px;
    }
    
    .performance-cards {
      grid-template-columns: 1fr;
      max-width: 300px;
    }
    
    .hero-buttons {
      flex-direction: column;
      align-items: center;
    }
    
    .btn {
      width: 100%;
      max-width: 300px;
      justify-content: center;
    }
  }
  
  @media (max-width: 576px) {
    .hero-title {
      font-size: 1.8rem;
    }
    
    .hero-subtitle {
      font-size: 1rem;
    }
    
    .section-title {
      font-size: 1.8rem;
    }
    
    .features-grid {
      grid-template-columns: 1fr;
    }
    
    .hero-badge {
      font-size: 14px;
      padding: 10px 20px;
    }
  }
</style>

<!-- Video Background -->
<div class="video-background">
  <video autoplay muted loop playsinline>
    <source src="{% static 'videos/SHOPVIEW.mp4' %}" type="video/mp4">
  </video>
</div>

<!-- Gradient Background -->
<div class="gradient-bg"></div>

<!-- Content Overlay for Better Readability -->
<div class="content-overlay">
  <!-- Top Search -->
  <section class="top-search-section">
    <form method="GET" action="{% url 'search' %}" class="top-search-form" id="topSearchForm">
      <input 
        type="text" 
        name="q" 
        class="top-search-input" 
        placeholder="üîç Search smartphones, accessories, and more..." 
        autocomplete="off"
        id="topSearchInput"
        value="{{ request.GET.q|default:'' }}"
      >
      <button type="submit" class="top-search-btn">
        <span>SEARCH</span>
      </button>
    </form>
  </section>

  <!-- Hero Section - REDESIGNED WITH 3 COLUMNS -->
  <section class="hero" id="home">
    <div class="hero-content">
      <div class="hero-grid-3col">
        <!-- COLUMN 1 - LEFT IMAGE SLIDESHOW -->
        <div class="hero-image-column">
          <div class="hero-slideshow-small" id="leftSlideshow">
            <div class="slideshow-container-small">
              <div class="slide-small active" data-slide-index="0">
                <div class="slide-small-title">EXPERT PHONE REPAIRS</div>
                <img src="{% static 'images/REPAIRS.png' %}" alt="Professional Phone Repairs" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="1">
                <div class="slide-small-title">PREMIUM AUDIO GEAR</div>
                <img src="{% static 'images/HEADPHONES.webp' %}" alt="High-Quality Earpods" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="2">
                <div class="slide-small-title">ACCESSORIES GALORE</div>
                <img src="{% static 'images/GALORE.png' %}" alt="Phone Accessories" loading="lazy">
              </div>
            </div>
            <div class="slideshow-nav-small">
              <span class="nav-dot-small active" onclick="goToLeftSlide(0)"></span>
              <span class="nav-dot-small" onclick="goToLeftSlide(1)"></span>
              <span class="nav-dot-small" onclick="goToLeftSlide(2)"></span>
            </div>
          </div>
          
          <div class="hero-slideshow-small" id="leftSlideshow2">
            <div class="slideshow-container-small">
              <div class="slide-small active" data-slide-index="0">
                <div class="slide-small-title">POWER BANKS</div>
                <img src="{% static 'images/POWERBANK.webp' %}" alt="Power Banks" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="1">
                <div class="slide-small-title">CHARGING SOLUTIONS</div>
                <img src="{% static 'images/CHARGER.webp' %}" alt="Chargers" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="2">
                <div class="slide-small-title">SMART GADGETS</div>
                <img src="{% static 'images/PHANTOM.png' %}" alt="Smart Gadgets" loading="lazy">
              </div>
            </div>
            <div class="slideshow-nav-small">
              <span class="nav-dot-small active" onclick="goToLeftSlide2(0)"></span>
              <span class="nav-dot-small" onclick="goToLeftSlide2(1)"></span>
              <span class="nav-dot-small" onclick="goToLeftSlide2(2)"></span>
            </div>
          </div>
        </div>
        
        <!-- COLUMN 2 - CENTER MAIN CONTENT -->
        <div class="hero-center-column">
          <div class="hero-badge">
            <span>‚ö°</span>
            <span>PREMIUM TECH ‚Ä¢ UNBEATABLE PRICES</span>
          </div>
          
          <div class="hero-text-slideshow">
            <div class="text-slide active">
              <h1 class="hero-title">
                DISCOVER<br>
                <span class="highlight">TECHNOLOGY</span>
              </h1>
              <p class="hero-subtitle">
                New arrivals to all our products. Quality meets affordability.
              </p>
            </div>
            
            <div class="text-slide">
              <h1 class="hero-title">
                SMART<br>
                <span class="highlight">INNOVATION</span>
              </h1>
              <p class="hero-subtitle">
                Latest innovations in mobile technology at your fingertips.
              </p>
            </div>
            
            <div class="text-slide">
              <h1 class="hero-title">
                PREMIUM<br>
                <span class="highlight">QUALITY</span>
              </h1>
              <p class="hero-subtitle">
                Every product is handpicked for exceptional quality and performance.
              </p>
            </div>
          </div>
          
          <div class="text-slideshow-nav">
            <span class="text-nav-dot active" onclick="goToTextSlide(0)"></span>
            <span class="text-nav-dot" onclick="goToTextSlide(1)"></span>
            <span class="text-nav-dot" onclick="goToTextSlide(2)"></span>
          </div>
          
          <div class="hero-buttons">
            <a href="{% url 'shop' %}" class="btn btn-primary">
              <span>üõçÔ∏è</span>
              <span>START SHOPPING</span>
            </a>
            <a href="#best-selling" class="btn btn-secondary">
              <span>üî•</span>
              <span>BEST DEALS</span>
            </a>
          </div>
        </div>
        
        <!-- COLUMN 3 - RIGHT IMAGE SLIDESHOW -->
        <div class="hero-image-column">
          <div class="hero-slideshow-small" id="rightSlideshow">
            <div class="slideshow-container-small">
              <div class="slide-small active" data-slide-index="0">
                <div class="slide-small-title">TECNO SERIES</div>
                <img src="{% static 'images/NT1.png' %}" alt="Tecno  Premium Featurephone" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="1">
                <div class="slide-small-title">FLAGSHIP DEVICES</div>
                <img src="{% static 'images/NO1.png' %}" alt="Flagship Oking Featurephone" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="2">
                <div class="slide-small-title">SAMSUNG GALAXY</div>
                <img src="{% static 'images/SAMSUNG.png' %}" alt="Samsung Galaxy Smartphones" loading="lazy">
              </div>
            </div>
            <div class="slideshow-nav-small">
              <span class="nav-dot-small active" onclick="goToRightSlide(0)"></span>
              <span class="nav-dot-small" onclick="goToRightSlide(1)"></span>
              <span class="nav-dot-small" onclick="goToRightSlide(2)"></span>
            </div>
          </div>
          
          <div class="hero-slideshow-small" id="rightSlideshow2">
            <div class="slideshow-container-small">
              <div class="slide-small active" data-slide-index="0">
                <div class="slide-small-title">SMART WATCHES</div>
                <img src="{% static 'images/WATCH.jpg' %}" alt="Smart Watches" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="1">
                <div class="slide-small-title">FITNESS TRACKERS</div>
                <img src="{% static 'images/TRACKER.png' %}" alt="Fitness Trackers" loading="lazy">
              </div>
              <div class="slide-small" data-slide-index="2">
                <div class="slide-small-title">TABLETS</div>
                <img src="{% static 'images/TAB.jpg' %}" alt="Galaxy Tablets" loading="lazy">
              </div>
            </div>
            <div class="slideshow-nav-small">
              <span class="nav-dot-small active" onclick="goToRightSlide2(0)"></span>
              <span class="nav-dot-small" onclick="goToRightSlide2(1)"></span>
              <span class="nav-dot-small" onclick="goToRightSlide2(2)"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Marquee Section -->
    <div class="marquee-container">
      <div class="marquee">
        <div class="marquee-content">
          <div class="marquee-item"><span>üì±</span><span>SMARTPHONES</span></div>
          <div class="marquee-item"><span>üéß</span><span>HEADPHONES</span></div>
          <div class="marquee-item"><span>‚åö</span><span>SMARTWATCHES</span></div>
          <div class="marquee-item"><span>üíª</span><span>LAPTOPS</span></div>
          <div class="marquee-item"><span>üîã</span><span>POWER BANKS</span></div>
          <div class="marquee-item"><span>üì±</span><span>ACCESSORIES</span></div>
        </div>
        <div class="marquee-content" aria-hidden="true">
          <div class="marquee-item"><span>üì±</span><span>SMARTPHONES</span></div>
          <div class="marquee-item"><span>üéß</span><span>HEADPHONES</span></div>
          <div class="marquee-item"><span>‚åö</span><span>SMARTWATCHES</span></div>
          <div class="marquee-item"><span>üíª</span><span>LAPTOPS</span></div>
          <div class="marquee-item"><span>üîã</span><span>POWER BANKS</span></div>
          <div class="marquee-item"><span>üì±</span><span>ACCESSORIES</span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Stats -->
  <section class="stats-section" id="stats">
    <div class="container">
      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-number" data-target="1000">0+</span>
          <span class="stat-label">Premium Products</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" data-target="50000">0+</span>
          <span class="stat-label">Happy Customers</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" data-target="99">99%</span>
          <span class="stat-label">Satisfaction Rate</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">24/7</span>
          <span class="stat-label">Customer Support</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Best Selling - COMPRESSED CARDS & 6 PER ROW -->
  <section class="best-selling-section" id="best-selling">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">
          CUSTOMER FAVORITES
        </h2>
        <p class="section-subtitle">Top-rated products loved by thousands of customers</p>
      </div>
      
      <div class="performance-cards">
        <div class="performance-card">
          <div class="performance-icon"></div>
          <div class="performance-info">
            <div class="performance-value">98%</div>
            <div class="performance-label">Customer Satisfaction</div>
          </div>
        </div>
        <div class="performance-card">
          <div class="performance-icon"></div>
          <div class="performance-info">
            <div class="performance-value">{{ featured_products|length }}+</div>
            <div class="performance-label">Top Performing</div>
          </div>
        </div>
      </div>
      
      <div class="filters-container">
        <button class="filter-btn active" data-category="all">
          <span>üì¶</span>
          <span>All Products</span>
        </button>
        {% for cat in categories %}
          <button class="filter-btn" data-category="{{ cat.name|lower|slugify }}">
            <span>
              {% if "phone" in cat.name|lower %}üì±
              {% elif "headphone" in cat.name|lower %}üéß
              {% elif "watch" in cat.name|lower %}‚åö
              {% elif "laptop" in cat.name|lower %}üíª
              {% elif "accessory" in cat.name|lower %}üîß
              {% else %}üì¶{% endif %}
            </span>
            <span>{{ cat.name }}</span>
          </button>
        {% endfor %}
      </div>
      
      <!-- 6 CARDS PER ROW GRID -->
      <div class="best-selling-grid">
        {% if featured_products %}
          {% for product in featured_products %}
            <a href="{% url 'product_detail' product.id %}" class="best-selling-card-link" style="text-decoration: none; color: inherit;">
              <div class="best-selling-card" data-category="{{ product.category.name|lower|slugify }}">
                <div class="product-rank">
                  <span class="rank-number">#{{ forloop.counter }}</span>
                  {% if product.is_featured %}
                    <span class="rank-badge">BEST SELLER</span>
                  {% endif %}
                </div>
                
                <div class="product-image-container">
                  {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.display_name }}" class="product-image">
                  {% else %}
                    <div style="display:flex;align-items:center;justify-content:center;height:100%;color:#667eea;font-size:2rem;">
                      üì±
                    </div>
                  {% endif %}
                </div>
                
                <div class="product-content">
                  <div class="product-header">
                    <div class="product-sku">{{ product.product_code|slice:":6" }}</div>
                    {% if product.status == 'available' %}
                      <div class="stock-status available">IN STOCK</div>
                    {% elif product.status == 'lowstock' %}
                      <div class="stock-status lowstock">LOW STOCK</div>
                    {% else %}
                      <div class="stock-status outstock">SOLD OUT</div>
                    {% endif %}
                  </div>
                  
                  <h3 class="product-title">
                    {{ product.display_name|truncatechars:30 }}
                  </h3>
                  
                  <div class="stars">
                    <span class="star">‚≠ê</span><span class="star">‚≠ê</span><span class="star">‚≠ê</span><span class="star">‚≠ê</span><span class="star">‚≠ê</span>
                    <span class="rating-value">4.8</span>
                  </div>
                  
                  <div class="price-current">
                    KSh {{ product.selling_price|floatformat:0 }}
                    {% if product.buying_price and product.buying_price < product.selling_price %}
                      <div style="margin-top:5px;">
                        <span class="save-badge">
                          SAVE {{ product.profit_margin|floatformat:0 }}
                        </span>
                      </div>
                    {% endif %}
                  </div>
                  
                  <div class="product-actions">
                    {% if product.status == 'available' or product.status == 'lowstock' %}
                      <button class="action-btn add-cart-btn"
                              data-product-id="{{ product.id }}"
                              data-product-name="{{ product.display_name }}"
                              data-product-price="{{ product.selling_price }}"
                              onclick="event.preventDefault(); addToCart(event, '{{ product.id }}', '{{ product.display_name|escapejs }}', '{{ product.selling_price }}')">
                        <span class="btn-icon">üõí</span>
                        <span>ADD</span>
                      </button>
                      <button class="action-btn wishlist-btn" 
                              onclick="event.preventDefault(); addToWishlist(event, '{{ product.id }}', '{{ product.display_name|escapejs }}')"
                              title="Add to Wishlist">
                        <span class="btn-icon">‚ù§Ô∏è</span>
                      </button>
                    {% else %}
                      <button class="action-btn add-cart-btn" disabled>
                        <span class="btn-icon">‚è≥</span>
                        <span>SOLD OUT</span>
                      </button>
                    {% endif %}
                  </div>
                  
                  <div class="quick-stats">
                    <div class="stat-item">
                      <span>üöö</span>
                      <span>Shipping</span>
                    </div>
                    <div class="stat-item">
                      <span>üîí</span>
                      <span>Warranty</span>
                    </div>
                    <div class="stat-item">
                      <span>‚ú®</span>
                      <span>New</span>
                    </div>
                  </div>
                </div>
              </div>
            </a>
          {% endfor %}
        {% else %}
          <div class="no-products">
            <div style="font-size:3rem;margin-bottom:15px;">üì±</div>
            <h3>No Featured Products Available</h3>
            <p style="margin-bottom:20px;font-size:1rem;">Check back soon for our latest arrivals</p>
            <a href="{% url 'shop' %}" class="view-more-btn" style="margin-top:10px;">
              <span>BROWSE ALL PRODUCTS</span>
            </a>
          </div>
        {% endif %}
      </div>
      
      <div class="view-more-container">
        <a href="{% url 'shop' %}" class="view-more-btn">
          <span>EXPLORE FULL CATALOG</span>
          <span>‚Üí</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section class="features-section">
    <div class="container">
      <div class="features-grid">
        <div class="feature-card">
          <span class="feature-icon">üöö</span>
          <h3 class="feature-title">Fast Delivery</h3>
          <p class="feature-description">Same-day delivery in major cities. We deliver right to your doorstep.</p>
        </div>
        <div class="feature-card">
          <span class="feature-icon">üîí</span>
          <h3 class="feature-title">Secure Payment</h3>
          <p class="feature-description">100% secure payment options with encryption for your peace of mind.</p>
        </div>
        <div class="feature-card">
          <span class="feature-icon">üîÑ</span>
          <h3 class="feature-title">Easy Returns</h3>
          <p class="feature-description">14-day hassle-free return policy. Your satisfaction is guaranteed.</p>
        </div>
        <div class="feature-card">
          <span class="feature-icon">üìû</span>
          <h3 class="feature-title">24/7 Support</h3>
          <p class="feature-description">Round-the-clock customer support. We're always here to help you.</p>
        </div>
      </div>
    </div>
  </section>
</div>

<script>
  // Define functions first so they're available globally
  function addToCart(event, productId, productName, productPrice) {
    event.stopPropagation(); // Prevent card click
    
    // Get cart
    let cart = JSON.parse(localStorage.getItem('fieldmax_cart') || '[]');
    
    // Check if item already exists
    const existingIndex = cart.findIndex(item => item.id === productId);
    if (existingIndex > -1) {
      cart[existingIndex].quantity += 1;
    } else {
      cart.push({
        id: productId,
        name: productName,
        price: parseFloat(productPrice),
        quantity: 1,
        timestamp: Date.now()
      });
    }
    
    // Save
    localStorage.setItem('fieldmax_cart', JSON.stringify(cart));
    
    // Visual feedback
    const button = event.target.closest('.add-cart-btn');
    const originalHTML = button.innerHTML;
    const originalBg = button.style.background;
    button.innerHTML = '<span class="btn-icon">‚úÖ</span><span>ADDED!</span>';
    button.style.background = 'linear-gradient(135deg, #10b981, #059669)';
    button.style.transform = 'translateY(-3px) scale(1.05)';
    
    // Ripple effect
    const ripple = document.createElement('div');
    ripple.style.cssText = `
      position: absolute;
      border-radius: 50%;
      background: rgba(16, 185, 129, 0.4);
      transform: scale(0);
      animation: ripple 0.6s linear;
    `;
    
    const rect = button.getBoundingClientRect();
    const size = Math.max(rect.width, rect.height);
    const x = rect.width / 2 - size / 2;
    const y = rect.height / 2 - size / 2;
    
    ripple.style.width = ripple.style.height = size + 'px';
    ripple.style.left = x + 'px';
    ripple.style.top = y + 'px';
    
    button.style.position = 'relative';
    button.appendChild(ripple);
    
    setTimeout(() => {
      button.innerHTML = originalHTML;
      button.style.background = originalBg;
      button.style.transform = '';
      ripple.remove();
    }, 1500);
    
    // Show toast notification
    showToast(`${productName} added to cart`);
    
    // Update cart count
    updateCartCount();
  }

  function addToWishlist(event, productId, productName) {
    event.stopPropagation(); // Prevent card click
    
    // Get wishlist
    let wishlist = JSON.parse(localStorage.getItem('fieldmax_wishlist') || '[]');
    
    // Check if already in wishlist
    if (!wishlist.find(item => item.id === productId)) {
      wishlist.push({
        id: productId,
        name: productName,
        timestamp: Date.now()
      });
      
      // Save
      localStorage.setItem('fieldmax_wishlist', JSON.stringify(wishlist));
      
      // Visual feedback
      const button = event.target.closest('.wishlist-btn');
      const originalHTML = button.innerHTML;
      button.innerHTML = '<span class="btn-icon">‚ù§Ô∏è</span>';
      button.style.color = '#ef4444';
      button.style.transform = 'scale(1.2)';
      
      setTimeout(() => {
        button.innerHTML = originalHTML;
        button.style.color = '';
        button.style.transform = '';
      }, 1000);
      
      // Show toast
      showToast(`${productName} added to wishlist`);
    } else {
      showToast(`${productName} is already in your wishlist`);
    }
  }

  function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('fieldmax_cart') || '[]');
    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
    
    // Update cart icon in navbar if exists
    const cartIcon = document.querySelector('.cart-icon-count');
    if (cartIcon) {
      cartIcon.textContent = totalItems;
      if (totalItems > 0) {
        cartIcon.style.display = 'flex';
      }
    }
  }

  function showToast(message) {
    // Remove existing toast
    const existingToast = document.getElementById('toast');
    if (existingToast) existingToast.remove();
    
    // Create toast
    const toast = document.createElement('div');
    toast.id = 'toast';
    toast.style.cssText = `
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 16px 24px;
      border-radius: 12px;
      transform: translateX(400px);
      transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 10000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      gap: 12px;
      max-width: 350px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    `;
    
    toast.innerHTML = `
      <span style="font-size: 20px;">üéâ</span>
      <div>
        <div style="font-weight: 700; margin-bottom: 4px;">Success!</div>
        <div style="font-size: 14px; opacity: 0.9;">${message}</div>
      </div>
    `;
    
    document.body.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
      toast.style.transform = 'translateX(0)';
    }, 10);
    
    // Animate out and remove
    setTimeout(() => {
      toast.style.transform = 'translateX(400px)';
      setTimeout(() => {
        if (toast.parentNode) {
          toast.parentNode.removeChild(toast);
        }
      }, 400);
    }, 3000);
  }

  // Slideshow functions for 4 independent slideshows
  function initSlideshow(containerId, slideIntervalTime = 4000) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    const slides = container.querySelectorAll('.slide-small');
    const dots = container.querySelectorAll('.nav-dot-small');
    let currentSlide = 0;
    let interval;
    
    function showSlide(n) {
      slides[currentSlide].classList.remove('active');
      dots[currentSlide].classList.remove('active');
      currentSlide = (n + slides.length) % slides.length;
      slides[currentSlide].classList.add('active');
      dots[currentSlide].classList.add('active');
    }
    
    function startSlideShow() {
      interval = setInterval(() => {
        showSlide(currentSlide + 1);
      }, slideIntervalTime);
    }
    
    function stopSlideShow() {
      clearInterval(interval);
    }
    
    // Initialize slide indices
    slides.forEach((slide, index) => {
      slide.dataset.slideIndex = index;
    });
    
    startSlideShow();
    
    // Add hover pause
    container.addEventListener('mouseenter', stopSlideShow);
    container.addEventListener('mouseleave', startSlideShow);
    
    return { showSlide, currentSlide };
  }

  // Text slideshow functions
  window.goToTextSlide = function(n) {
    const textSlides = document.querySelectorAll('.text-slide');
    const textDots = document.querySelectorAll('.text-nav-dot');
    let currentTextSlide = parseInt(document.querySelector('.text-slide.active').dataset.slideIndex || 0);
    
    textSlides[currentTextSlide].classList.remove('active');
    textDots[currentTextSlide].classList.remove('active');
    currentTextSlide = n;
    textSlides[currentTextSlide].classList.add('active');
    textDots[currentTextSlide].classList.add('active');
  };

  // Left slideshow navigation functions
  window.goToLeftSlide = function(n) {
    const leftSlideshow = document.getElementById('leftSlideshow');
    const slides = leftSlideshow.querySelectorAll('.slide-small');
    const dots = leftSlideshow.querySelectorAll('.nav-dot-small');
    let currentSlide = parseInt(leftSlideshow.querySelector('.slide-small.active').dataset.slideIndex || 0);
    
    slides[currentSlide].classList.remove('active');
    dots[currentSlide].classList.remove('active');
    currentSlide = n;
    slides[currentSlide].classList.add('active');
    dots[currentSlide].classList.add('active');
  };

  window.goToLeftSlide2 = function(n) {
    const leftSlideshow2 = document.getElementById('leftSlideshow2');
    const slides = leftSlideshow2.querySelectorAll('.slide-small');
    const dots = leftSlideshow2.querySelectorAll('.nav-dot-small');
    let currentSlide = parseInt(leftSlideshow2.querySelector('.slide-small.active').dataset.slideIndex || 0);
    
    slides[currentSlide].classList.remove('active');
    dots[currentSlide].classList.remove('active');
    currentSlide = n;
    slides[currentSlide].classList.add('active');
    dots[currentSlide].classList.add('active');
  };

  // Right slideshow navigation functions
  window.goToRightSlide = function(n) {
    const rightSlideshow = document.getElementById('rightSlideshow');
    const slides = rightSlideshow.querySelectorAll('.slide-small');
    const dots = rightSlideshow.querySelectorAll('.nav-dot-small');
    let currentSlide = parseInt(rightSlideshow.querySelector('.slide-small.active').dataset.slideIndex || 0);
    
    slides[currentSlide].classList.remove('active');
    dots[currentSlide].classList.remove('active');
    currentSlide = n;
    slides[currentSlide].classList.add('active');
    dots[currentSlide].classList.add('active');
  };

  window.goToRightSlide2 = function(n) {
    const rightSlideshow2 = document.getElementById('rightSlideshow2');
    const slides = rightSlideshow2.querySelectorAll('.slide-small');
    const dots = rightSlideshow2.querySelectorAll('.nav-dot-small');
    let currentSlide = parseInt(rightSlideshow2.querySelector('.slide-small.active').dataset.slideIndex || 0);
    
    slides[currentSlide].classList.remove('active');
    dots[currentSlide].classList.remove('active');
    currentSlide = n;
    slides[currentSlide].classList.add('active');
    dots[currentSlide].classList.add('active');
  };

  document.addEventListener('DOMContentLoaded', function() {
    // Initialize slide indices for text slideshow
    document.querySelectorAll('.text-slide').forEach((slide, index) => {
      slide.dataset.slideIndex = index;
    });
    
    // Initialize all 4 image slideshows
    initSlideshow('leftSlideshow', 3500);
    initSlideshow('leftSlideshow2', 4000);
    initSlideshow('rightSlideshow', 3800);
    initSlideshow('rightSlideshow2', 4200);
    
    // Text Slideshow
    const textSlides = document.querySelectorAll('.text-slide');
    const textDots = document.querySelectorAll('.text-nav-dot');
    let currentTextSlide = 0;
    let textSlideInterval;
    
    function showTextSlide(n) {
      textSlides[currentTextSlide].classList.remove('active');
      textDots[currentTextSlide].classList.remove('active');
      currentTextSlide = (n + textSlides.length) % textSlides.length;
      textSlides[currentTextSlide].classList.add('active');
      textDots[currentTextSlide].classList.add('active');
    }
    
    function startTextSlideShow() {
      textSlideInterval = setInterval(() => {
        showTextSlide(currentTextSlide + 1);
      }, 4500);
    }
    
    startTextSlideShow();
    
    // Counters with improved animation
    document.querySelectorAll('[data-target]').forEach(counter => {
      const target = parseInt(counter.dataset.target);
      let current = 0;
      const increment = target / 50;
      
      const update = () => {
        if (current < target) {
          current += increment;
          counter.textContent = Math.ceil(current) + (counter.textContent.includes('%') ? '%' : '+');
          setTimeout(update, 30);
        } else {
          counter.textContent = target + (counter.textContent.includes('%') ? '%' : '+');
        }
      };
      
      const observer = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
          update();
        }
      }, { threshold: 0.5 });
      observer.observe(counter);
    });
    
    // Product Filters
    const filterBtns = document.querySelectorAll('.filter-btn');
    const productCards = document.querySelectorAll('.best-selling-card-link');
    
    filterBtns.forEach(btn => {
      btn.addEventListener('click', function() {
        filterBtns.forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const category = this.dataset.category;
        
        productCards.forEach(card => {
          const productCard = card.querySelector('.best-selling-card');
          if (category === 'all' || productCard.dataset.category === category) {
            card.style.display = 'block';
            setTimeout(() => {
              card.style.opacity = '1';
              card.style.transform = 'translateY(0)';
            }, 100);
          } else {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
              card.style.display = 'none';
            }, 300);
          }
        });
      });
    });
    
    // Top Search with improved UX
    const topSearchInput = document.getElementById('topSearchInput');
    const topSearchForm = document.getElementById('topSearchForm');
    
    topSearchInput.addEventListener('focus', function() {
      this.style.background = 'rgba(255, 255, 255, 0.2)';
    });
    
    topSearchInput.addEventListener('blur', function() {
      this.style.background = '';
    });
    
    topSearchForm.addEventListener('submit', function(e) {
      if (!topSearchInput.value.trim()) {
        e.preventDefault();
        topSearchInput.style.border = '2px solid #ef4444';
        setTimeout(() => {
          topSearchInput.style.border = '';
        }, 1000);
        topSearchInput.focus();
      }
    });
    
    // Initialize cart count
    updateCartCount();
    
    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          window.scrollTo({
            top: targetElement.offsetTop - 80,
            behavior: 'smooth'
          });
        }
      });
    });
  });
</script>

{% endblock %}